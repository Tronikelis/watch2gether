(this.webpackJsonpw2g=this.webpackJsonpw2g||[]).push([[20],{282:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return H}));var o=t(198),i=t(275),c=t(276),r=t(269),s=t(277),a=t(270),l=t(278),u=t(1),d=t(288),j=t(289),f=t(166),b=t(165),O=t(8),p=t(199),x=t.n(p)()(),h=new URL(window.location.href).pathname.replaceAll("/room/",""),v=t(229),g=t.n(v),m=t(230),y=g()((function(e){return{state:{playerInfo:{loaded:0,loadedSeconds:0,played:0,playedSeconds:0},video:"https://youtu.be/lADBHDg-JtA",playing:!1,users:1},actions:{setPlayerInfo:function(n){return e(Object(m.a)((function(e){e.state.playerInfo=n})))},setVideo:function(n){return e(Object(m.a)((function(e){e.state.video=n})))},setPlaying:function(n){return e(Object(m.a)((function(e){e.state.playing=n})))},setUsers:function(n){return e(Object(m.a)((function(e){e.state.users=n(e.state.users)})))}},modal:{open:!1,setOpen:function(n){return e(Object(m.a)((function(e){e.modal.open=n})))}}}})),w=t(231),I=t(284),S=t(232),k=t.n(S),C=t(272),P=t(10);function z(e){var n=Object(u.useRef)(null),t=y((function(e){return e.state.playing})),o=y((function(e){return e.actions.setPlaying})),i=y((function(e){return e.state.video})),c=y((function(e){return e.actions.setVideo})),r=y((function(e){return e.actions.setPlayerInfo})),s=function(e){var t;null===(t=n.current)||void 0===t||t.seekTo(e)},a=function(){var e,t;return null!==(e=null===(t=n.current)||void 0===t?void 0:t.getCurrentTime())&&void 0!==e?e:0};Object(u.useEffect)((function(){x.emit("join room",h),x.on("pause room",(function(){o(!1)})),x.on("play room",(function(e){var n=e.seconds;o(!0),console.log("Got seconds",n),Math.abs(a()-n)<2.5||s(n)})),x.on("sync room",(function(e){var n=e.socketId,t=a();x.emit("sync user",{socketId:n,seconds:t,video:y.getState().state.video})})),x.on("sync user",(function(e){var n=e.seconds,t=e.video;c(t),n&&(console.log("got sync",n),setTimeout((function(){return s(n+.3)}),150))})),x.on("video room",(function(e){var n=e.video;c(n)}))}),[]);var l=Object(C.a)((function(){o(!0);var e=a();console.log("Emitting seconds",e),x.emit("play room",{seconds:e,id:h})}),200);return Object(P.jsx)(k.a,Object(w.a)({ref:n,fallback:Object(P.jsx)(I.a,{isIndeterminate:!0}),url:i,controls:!0,muted:!0,width:"100%",height:"100%",playing:t,onReady:function(){o(!0),x.emit("sync room",{socketId:x.id,id:h})},onPlay:l,onPause:function(){o(!1),x.emit("pause room",h)},onProgress:function(e){return r(e)}},e))}var D,W=t(4),T=t(281),U=t(280),A=t(283),E=t(285),F=t(255),J=t(238);function R(){var e=y((function(e){return e.actions.setVideo})),n=y((function(e){return e.modal})),t=n.open,o=n.setOpen,i=Object(u.useState)(""),c=Object(W.a)(i,2),r=c[0],s=c[1],a=Object(T.a)();return Object(P.jsxs)(U.a,{isOpen:t,onClose:function(){return o(!1)},children:[Object(P.jsx)(U.g,{}),Object(P.jsxs)(U.d,{children:[Object(P.jsx)(U.c,{}),Object(P.jsx)(U.f,{children:"Input video url"}),Object(P.jsx)(U.b,{children:Object(P.jsx)(A.a,{placeholder:"Url",value:r,onChange:function(e){return s(e.target.value)}})}),Object(P.jsx)(U.e,{children:Object(P.jsxs)(E.a,{spacing:"3",children:[Object(P.jsx)(F.a,{onClick:function(){Object(J.isWebUri)(r)?(x.emit("video room",{id:h,video:r}),e(r)):a({title:"Denied",description:"The supplied url is invalid",status:"error",duration:3e3,isClosable:!0})},color:"blue.400",children:"Play"}),Object(P.jsx)(F.a,{onClick:function(){return o(!1)},children:"Close"})]})})]})]})}var V=f.a.div(D||(D=Object(o.a)(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: space-evenly;\n    align-items: center;\n    flex-wrap: wrap;\n"])));function H(){var e=Object(O.f)();return Object(u.useEffect)((function(){Object(d.a)(h)||e.push("/404")}),[]),Object(P.jsx)(i.a,{maxH:"100vh",h:"100vh",w:"100vw",maxW:"100vw",overflow:"hidden",padding:"45px",children:Object(P.jsxs)(V,{children:[Object(P.jsx)(c.a,{w:"80%",h:"full",children:Object(P.jsx)(L,{})}),Object(P.jsx)(r.a,{w:"15%",h:"full",borderWidth:"1px",flexDir:"column",children:Object(P.jsx)(B,{})})]})})}function L(){return Object(P.jsx)(s.a,{ratio:16/9,w:"full",h:"full",children:Object(P.jsx)(z,{})})}function B(){var e=y((function(e){return e.modal.setOpen})),n=y((function(e){return e.state.playerInfo})),t=n.playedSeconds,o=n.loadedSeconds,i=y((function(e){return e.state.playing}));return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)(r.a,{padding:"10px",w:"full",h:"10%",wrap:"wrap",justifyContent:"space-between",alignItems:"center",children:[Object(P.jsx)(a.a,{fontSize:"xl",fontWeight:"bold",children:"Search video"}),Object(P.jsx)(l.a,{icon:Object(P.jsx)(j.a,{}),"aria-label":"Input url",onClick:function(){return e(!0)}}),Object(P.jsx)(R,{})]}),Object(P.jsxs)(r.a,{flexDir:"column",alignItems:"center",justifyContent:"center",w:"full",h:"full",children:[Object(P.jsx)(a.a,{fontSize:"3xl",fontWeight:"bold",align:"center",children:"Info"}),Object(P.jsxs)(a.a,{fontSize:"xl",align:"center",children:["Seconds: "," ",t.toFixed(2).split("").map((function(e,n){return Object(P.jsx)(b.a,{text:e,direction:"down",inline:!0},n)}))]}),Object(P.jsxs)(a.a,{fontSize:"xl",align:"center",children:["Loaded: "," ",o.toFixed(2).split("").map((function(e,n){return Object(P.jsx)(b.a,{text:e,direction:"down",inline:!0},n)}))]}),Object(P.jsx)("div",{style:{height:20}}),Object(P.jsxs)(a.a,{fontSize:"xl",align:"center",children:["Playing: "," ","".concat(i).split("").map((function(e,n){return Object(P.jsx)(b.a,{text:e,direction:"down",inline:!0},n)}))]})]})]})}}}]);